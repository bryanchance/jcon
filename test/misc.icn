record message(who,gap,what)

procedure main()
   local i, x

   x := 1
   x +:= |1		# tickled optimizer bug.
   write(x)

   x := table(3)
   write(x[])

   x := "o"
   write("a" & "b")
   write("c" | "d")
   write(\"e")
   write(!"f")
   write(\&null | "g")
   write(/&null & "h")
   write("i" || "jk")
   write(23 || "skidoo")
   write(x, .x, x := "b")

   every (write|"write")( (1|2)("hello", "mom"), "!")
   every (write|"write")! [ (1|2) ! ["hello", "mom"], "!"]
   write ! message("hello")
   write ! message("hello", " ", "pop")
   every i := -4 to 4 do
      write("i=", i, ": ", i("a","b","c") | "failed")

   every write(seq() \ 3)
   every write(seq(4) \ 3)
   every write(seq(,4) \ 3)
   every write(seq(10,20) \ 3)

   pairs { 1 to 100, 11 to 99 by 11 }

   write("repl: ", repl("",5), repl("x",3), repl("foo",0), repl("xyz",4))
   write("reverse: ", reverse(""), reverse("x"), reverse("ab"), reverse(12345));
   every i := 0 to 255 do
      if (ord(char(i)) ~= i) then write("char/ord oops ", i)
   writes("char: ") 
   every writes(char((64 to 126) | 10))

   # the following should all be harmless, at least
   every collect(&null | (0 to 3), &null | 0 | 1 | 100 | 1000)

   write("done")
   exit()
   write("oops!")
end

procedure pairs(e)
   while write(@e[1], " ", @e[2])
end
