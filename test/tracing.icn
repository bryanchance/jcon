#SRC: JCON
#OPTS: -en

#  test tracing of procedure calls

procedure main()
   &trace := -1
   every recurse(0 to 3)
   every divall("" | "314" | "x" | "12x")
end


#  test tracing of recursion

procedure recurse(n)
   if n > 0 then
      return recurse(n - 1) + 1
   failer()
   every genr(5, 12, 4)
   return func(3, 4)
end

procedure failer()
   fail
end

procedure func(a, b)
   return 3 * abs(a) + b
end

procedure genr(i, j, k)
   suspend i to j by k
end


#  test tracing in combination with errors

procedure divall(s)
   &error := 1
   every divide(9, !s)
   &error := 0
   return
end

procedure divide(a, b)
   return a / b
end
